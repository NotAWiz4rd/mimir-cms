<!DOCTYPE html>
<html lang="de" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title th:text="'Mimir - '+${isRootFolder?'/':folder.getDisplayName()}">Mimir</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/general.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/content.css}">
    <link rel="icon" type="image/png" th:href="@{/favicon.png}">
</head>
<body>
<nav>
    <ul id="leftmenu">
        <li>
            <a th:href="@{__${applicationBaseUrl}__/}">Home</a>
        </li>
        <li>
            <a id="initial-checkin-artifact-button" class="enabled">Neues Artefakt einchecken</a>
        </li>
        <li>
            <div id="initial-checkin-artifact" class="action" style="display: none">
                <form th:action="@{/artifact}" th:method="post" enctype="multipart/form-data">
                    <label>Name:</label>
                    <input name="name" type="text"/>
                    <input class="fileupload" name="file" type="file" size="50" accept="*">
                    <input name="currentUrl" type="hidden" th:value="${currentUrl}"/>
                    <input class="actionSubmit" type="submit" value="Bestätigen"/>
                </form>
            </div>
        </li>
        <li>
            <a id="create-folder-button" class="enabled">Neuen Ordner erstellen</a>
        </li>
        <li>
            <div id="create-folder" class="action" style="display: none">
                <form th:action="@{/folder}" th:method="post">
                    <label>Name:</label>
                    <input name="name" type="text"/>
                    <input name="currentUrl" type="hidden" th:value="${currentUrl}"/>
                    <input class="actionSubmit" type="submit" value="Bestätigen"/>
                </form>
            </div>
        </li>
        <li>
            <a id="rename-folder-button" th:class="${isRootFolder?'disabled':'enabled'}">Diesen Ordner umbenennen</a>
        </li>
        <li>
            <div id="rename-folder" class="action" style="display: none">
                <form th:if="${!isRootFolder}" th:action="@{/folder/__${folder.getId()}__}" th:method="put">
                    <label>Neuer Name:</label>
                    <input name="newName" type="text"/>
                    <input class="actionSubmit" type="submit" value="Bestätigen"/>
                </form>
            </div>
        </li>
        <li>
            <a id="delete-folder-button" th:class="${(isRootFolder || !content.isEmpty())?'disabled':'enabled'}">Diesen Ordner löschen</a>
        </li>
        <li>
            <div id="delete-folder" class="action" style="display: none">
                <form th:if="${!isRootFolder}" th:action="@{/folder/__${folder.getId()}__}" th:method="delete">
                    <input class="actionSubmit" type="submit" value="Bestätigen"/>
                </form>
            </div>
        </li>
        <li>
            <a th:href="@{/anleitung.pdf}">Hilfe</a>
        </li>
        <li>
            <a th:href="@{/impressum}">Impressum</a>
        </li>
        <li>
            <form th:action="@{/logout}" method="post">
                <a class=enabled onclick="this.parentNode.submit()"><span th:text="${currentUser}"></span> abmelden</a>
            </form>
        </li>
    </ul>
</nav>

<div class="layoutcontainer" id="layoutcontainer">
    <div id="pathContainer">
        <p>
            <a style="text-decoration: none" th:class="${isRootFolder?'hidden_element':''}" th:href="@{__${applicationBaseUrl}____${parentUrl}__}">←</a>
        </p>
        <p th:text="${currentUrl}"></p>
    </div>
    <div class="artifactcontainer" id="artifactcontainer">
        <a class="item" th:each="element : ${content}" th:with="thumbnailLink=@{__${T(de.seprojekt.se2019.g4.mimir.content.thumbnail.ThumbnailController).getLinkToSymbolOrThumbnail(element)}__}" th:style="'background:url('+${thumbnailLink}+') no-repeat center center; background-size: cover;'" th:href="@{(${applicationBaseUrl}+${element.getTotalUrl()}+(${element.isArtifact()}?'?preview':''))}">
            <div style="background-color:rgba(0, 0, 0, 0.5); ">
                <span style="color: white; text-decoration: none; display: block; width: auto; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;" th:text="(${element.isLocked()}?'**GESPERRT** von '+${element.getLockedByName()}+': ':'') +${element.getDisplayName()} "></span>
            </div>
        </a>
    </div>
</div>

<script th:src="@{/js/hideandshowactions.js}" type="text/javascript"></script>
<script>
    registerShowActionOnClick("create-folder-button", "create-folder");
    registerShowActionOnClick("rename-folder-button", "rename-folder");
    registerShowActionOnClick("delete-folder-button", "delete-folder");
    registerShowActionOnClick("initial-checkin-artifact-button", "initial-checkin-artifact");
</script>
</body>
</html>
